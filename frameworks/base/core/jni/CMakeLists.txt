project(libandroid_runtime)

set(ANDROID_RUNTIME_ROOT ${ANDROID_ROOT}/frameworks/base/core/jni)

set(SOURCE_FILES
        ${ANDROID_RUNTIME_ROOT}/AndroidRuntime.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_content_NativeLibraryHelper.cpp
        ${ANDROID_RUNTIME_ROOT}/com_google_android_gles_jni_EGLImpl.cpp
        ${ANDROID_RUNTIME_ROOT}/com_google_android_gles_jni_GLImpl.cpp
        ${ANDROID_RUNTIME_ROOT}/android_app_Activity.cpp
        ${ANDROID_RUNTIME_ROOT}/android_app_ApplicationLoaders.cpp
        ${ANDROID_RUNTIME_ROOT}/android_app_NativeActivity.cpp
        ${ANDROID_RUNTIME_ROOT}/android_app_admin_SecurityLog.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_EGL14.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_EGLExt.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES10.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES10Ext.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES11.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES11Ext.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES20.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES30.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES31.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES31Ext.cpp
        ${ANDROID_RUNTIME_ROOT}/android_opengl_GLES32.cpp
        ${ANDROID_RUNTIME_ROOT}/android_database_CursorWindow.cpp
        ${ANDROID_RUNTIME_ROOT}/android_database_SQLiteCommon.cpp
        ${ANDROID_RUNTIME_ROOT}/android_database_SQLiteConnection.cpp
        ${ANDROID_RUNTIME_ROOT}/android_database_SQLiteGlobal.cpp
        ${ANDROID_RUNTIME_ROOT}/android_database_SQLiteDebug.cpp
        ${ANDROID_RUNTIME_ROOT}/android_graphics_drawable_AnimatedVectorDrawable.cpp
        ${ANDROID_RUNTIME_ROOT}/android_graphics_drawable_VectorDrawable.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_DisplayEventReceiver.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_DisplayListCanvas.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_HardwareLayer.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_InputChannel.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_InputDevice.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_InputEventReceiver.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_InputEventSender.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_InputQueue.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_KeyCharacterMap.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_KeyEvent.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_MotionEvent.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_PointerIcon.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_RenderNode.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_RenderNodeAnimator.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_Surface.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_SurfaceControl.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_SurfaceSession.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_TextureView.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_ThreadedRenderer.cpp
        ${ANDROID_RUNTIME_ROOT}/android_view_VelocityTracker.cpp
        ${ANDROID_RUNTIME_ROOT}/android_text_AndroidCharacter.cpp
        ${ANDROID_RUNTIME_ROOT}/android_text_AndroidBidi.cpp
        ${ANDROID_RUNTIME_ROOT}/android_text_StaticLayout.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_Debug.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_GraphicsEnvironment.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_HwBinder.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_HwBlob.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_HwParcel.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_HwRemoteBinder.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_MemoryFile.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_MessageQueue.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_Parcel.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_SELinux.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_seccomp.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_SharedMemory.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_SystemClock.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_SystemProperties.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_Trace.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_UEventObserver.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_VintfObject.cpp
        ${ANDROID_RUNTIME_ROOT}/android_os_VintfRuntimeInfo.cpp
        ${ANDROID_RUNTIME_ROOT}/android_net_LocalSocketImpl.cpp
        ${ANDROID_RUNTIME_ROOT}/android_net_NetUtils.cpp
        ${ANDROID_RUNTIME_ROOT}/android_net_TrafficStats.cpp
        ${ANDROID_RUNTIME_ROOT}/android_nio_utils.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_AssetManager.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_Binder.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_EventLog.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_MemoryIntArray.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_Log.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_PathParser.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_Process.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_StringBlock.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_XmlBlock.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_jar_StrictJarFile.cpp
        ${ANDROID_RUNTIME_ROOT}/android_graphics_Canvas.cpp
        ${ANDROID_RUNTIME_ROOT}/android_graphics_Picture.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Bitmap.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/BitmapFactory.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Camera.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/CanvasProperty.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/ColorFilter.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/DrawFilter.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/FontFamily.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/FontUtils.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/CreateJavaOutputStreamAdaptor.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/GIFMovie.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/GraphicBuffer.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Graphics.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/HarfBuzzNGFaceSkia.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Interpolator.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/MaskFilter.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Matrix.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Movie.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/MovieImpl.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/NinePatch.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/NinePatchPeeker.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Paint.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Path.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/PathMeasure.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/PathEffect.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Picture.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/BitmapRegionDecoder.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Region.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Shader.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/SurfaceTexture.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Typeface.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/Utils.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/YuvToJpegEncoder.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/pdf/PdfDocument.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/pdf/PdfEditor.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/pdf/PdfRenderer.cpp
        ${ANDROID_RUNTIME_ROOT}/android/graphics/pdf/PdfUtils.cpp
        ${ANDROID_RUNTIME_ROOT}/android_media_AudioRecord.cpp
        ${ANDROID_RUNTIME_ROOT}/android_media_AudioSystem.cpp
        ${ANDROID_RUNTIME_ROOT}/android_media_AudioTrack.cpp
        ${ANDROID_RUNTIME_ROOT}/android_media_DeviceCallback.cpp
        ${ANDROID_RUNTIME_ROOT}/android_media_JetPlayer.cpp
        ${ANDROID_RUNTIME_ROOT}/android_media_RemoteDisplay.cpp
        ${ANDROID_RUNTIME_ROOT}/android_media_ToneGenerator.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_Camera.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_camera2_CameraMetadata.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_camera2_legacy_LegacyCameraDevice.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_camera2_legacy_PerfMeasurement.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_camera2_DngCreator.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_display_DisplayViewport.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_HardwareBuffer.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_SensorManager.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_SerialPort.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_SoundTrigger.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_UsbDevice.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_UsbDeviceConnection.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_UsbRequest.cpp
        ${ANDROID_RUNTIME_ROOT}/android_hardware_location_ActivityRecognitionHardware.cpp
        ${ANDROID_RUNTIME_ROOT}/android_util_FileObserver.cpp
        ${ANDROID_RUNTIME_ROOT}/android/opengl/poly_clip.cpp
        ${ANDROID_RUNTIME_ROOT}/android/opengl/util.cpp
        ${ANDROID_RUNTIME_ROOT}/android_server_NetworkManagementSocketTagger.cpp
        ${ANDROID_RUNTIME_ROOT}/android_server_Watchdog.cpp
        ${ANDROID_RUNTIME_ROOT}/android_ddm_DdmHandleNativeHeap.cpp
        ${ANDROID_RUNTIME_ROOT}/android_backup_BackupDataInput.cpp
        ${ANDROID_RUNTIME_ROOT}/android_backup_BackupDataOutput.cpp
        ${ANDROID_RUNTIME_ROOT}/android_backup_FileBackupHelperBase.cpp
        ${ANDROID_RUNTIME_ROOT}/android_backup_BackupHelperDispatcher.cpp
        ${ANDROID_RUNTIME_ROOT}/android_app_backup_FullBackup.cpp
        ${ANDROID_RUNTIME_ROOT}/android_content_res_ObbScanner.cpp
        ${ANDROID_RUNTIME_ROOT}/android_content_res_Configuration.cpp
        ${ANDROID_RUNTIME_ROOT}/android_animation_PropertyValuesHolder.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_net_NetworkStatsFactory.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_os_ClassLoaderFactory.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_os_FuseAppLoop.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_os_Zygote.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_os_ZygoteInit.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_util_VirtualRefBasePtr.cpp
        ${ANDROID_RUNTIME_ROOT}/com_android_internal_view_animation_NativeInterpolatorFactoryHelper.cpp
        ${ANDROID_RUNTIME_ROOT}/hwbinder/EphemeralStorage.cpp
        ${ANDROID_RUNTIME_ROOT}/fd_utils.cpp
        )

include_directories(${ANDROID_RUNTIME_ROOT}/android/graphics)
include_directories(${ANDROID_ROOT}/bionic/libc/private)
include_directories(${ANDROID_ROOT}/external/skia/include/private)
include_directories(${ANDROID_ROOT}/external/skia/src/codec)
include_directories(${ANDROID_ROOT}/external/skia/src/core)
include_directories(${ANDROID_ROOT}/external/skia/src/effects)
include_directories(${ANDROID_ROOT}/external/skia/src/image)
include_directories(${ANDROID_ROOT}/external/skia/src/images)
include_directories(${ANDROID_ROOT}/frameworks/base/media/jni)
include_directories(${ANDROID_ROOT}/libcore/include)
include_directories(${ANDROID_ROOT}/system/media/camera/include)
include_directories(${ANDROID_ROOT}/system/media/private/camera/include)
include_directories(${ANDROID_ROOT}/frameworks/native/include)
include_directories(${ANDROID_ROOT}/frameworks/av/include)



add_library(libandroid_runtime SHARED ${SOURCE_FILES})
target_include_directories(libandroid_runtime PUBLIC
        ${ANDROID_RUNTIME_ROOT}
        ${ANDROID_RUNTIME_ROOT}/include
        ${ANDROID_ROOT}/frameworks/base/libs/hwui
        ${ANDROID_ROOT}/frameworks/rs
        ${ANDROID_ROOT}/frameworks/rs/cpp
        ${ANDROID_ROOT}/frameworks/native/libs/nativewindow/include
        ${ANDROID_ROOT}/frameworks/native/libs/nativebase/include
        ${ANDROID_ROOT}/frameworks/native/libs/arect/include
        ${ANDROID_ROOT}/libnativehelper/include_jni
        ${ANDROID_ROOT}/libnativehelper/platform_include
        ${ANDROID_ROOT}/libnativehelper/include
        )
target_compile_definitions(libandroid_runtime PRIVATE
        -D__ANDROID_DEBUGGABLE__
        -DGL_GLEXT_PROTOTYPES
        -DEGL_EGLEXT_PROTOTYPES
        -DU_USING_ICU_NAMESPACE=0
        )
target_compile_options(libandroid_runtime PRIVATE
        -Wall
        -Werror
        -Wno-unused-parameter
        -Wno-non-virtual-dtor
        #-Wno-maybe-uninitialized
        -Wno-parentheses
        -Wno-error=deprecated-declarations
        -Wunused
        -Wunreachable-code
        -Wno-unknown-pragmas
        -Wno-conversion-null
        )
target_link_libraries(libandroid_runtime
        libgif
        libseccomp_policy
        libselinux
        libgrallocusage

        libmemtrack
        libandroidfw
        libappfuse
        libbase
        libcrypto
        libnativehelper
        liblog
        libcutils
        libdebuggerd_client
        libutils
        libbinder
        libui
        libgraphicsenv
        libgui
        libsensor
        libinput
        libcamera_client
        libcamera_metadata
        libskia
        libsqlite
        libEGL
        libGLESv1_CM
        libGLESv2
        libvulkan
        libziparchive
        libETC1
        libhardware
        libhardware_legacy
        libselinux
        libicuuc
        libmedia
        libaudioclient
        libjpeg
        libusbhost
        libharfbuzz_ng
        libz
        libpdfium
        libimg_utils
        libnetd_client
        libsoundtrigger
        libminikin
        libprocessgroup
        libnativebridge
        libnativeloader
        libmemunreachable
        libhidlbase
        libhidltransport
        libhwbinder
        libvintf
        libnativewindow
        libhwui
        )